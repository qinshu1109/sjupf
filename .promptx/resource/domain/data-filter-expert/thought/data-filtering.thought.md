<thought>
  <exploration>
    ## 数据过滤领域探索
    
    ### 电商数据特征分析
    - **多维度复杂性**：销量、GMV、佣金、排名、转化率等多个维度相互影响
    - **时间敏感性**：7天、30天、1年等不同时间窗口的数据价值不同
    - **业务周期性**：节日、促销等营销节点对数据权重的影响
    - **数据质量挑战**：缺失值、异常值、数据分布不均等问题
    
    ### 评分算法设计思路
    - **长尾截断**：处理极值，避免少数异常数据影响整体评分
    - **非线性变换**：对数变换、指数衰减等，更好反映业务规律
    - **分段评分**：不同区间采用不同评分策略，精细化处理
    - **权重动态调整**：根据业务场景自动调整各维度权重
    
    ### 节日模式的商业逻辑
    - **销量敏感性**：节日期间销量数据更能反映商品潜力
    - **排名重要性**：销量榜在节日期间具有更高的参考价值
    - **时间窗口**：45天的提前期符合电商备货和营销准备周期
    - **权重平衡**：动态调整保持评分体系的整体平衡
  </exploration>
  
  <reasoning>
    ## 算法设计推理逻辑
    
    ### 多维度评分体系构建
    ```
    总分 = Σ(维度得分 × 权重)
    
    维度包括：
    - 销量/GMV表现 (标准化处理)
    - Commission激励 (分段评分)  
    - 达人影响力 (余弦衰减)
    - 排名表现 (指数衰减+类型基础分)
    - 增长潜力 (销售1y×增长率)
    - 渠道分布 (live/card渠道得分)
    - 转化效率 (阈值过滤+线性映射)
    ```
    
    ### 节日模式权重调整逻辑
    ```
    if 距离下一节日 <= 45天:
        sales_7d_weight += 0.02
        if rank_type == '销量榜':
            rank_base_score += 0.02
        其他权重 *= (1 - 增加的权重) / 原总权重
    ```
    
    ### 数据处理流水线
    ```
    原始数据 → 质量检查 → 异常值处理 → 标准化 → 
    多维度评分 → 权重计算 → 总分排序 → TOP50筛选 → 去重输出
    ```
    
    ### 性能优化考虑
    - **向量化计算**：利用pandas/numpy的向量化操作提升性能
    - **内存管理**：分批处理大文件，避免内存溢出
    - **算法复杂度**：选择O(n)或O(nlogn)的高效算法
    - **缓存机制**：重复计算的中间结果进行缓存
  </reasoning>
  
  <challenge>
    ## 关键挑战与解决方案
    
    ### 数据质量挑战
    - **缺失值处理**：不同字段采用不同的填充策略
    - **异常值识别**：基于统计学方法的异常值检测
    - **数据类型转换**：智能识别并转换数据类型
    - **编码问题**：自动检测文件编码，确保中文正确显示
    
    ### 算法公平性问题
    - **维度权重平衡**：避免某个维度过度主导评分结果
    - **类别偏见**：不同rank_type的公平性处理
    - **时间窗口偏见**：短期和长期数据的平衡
    - **规模效应**：大商家和小商家的公平竞争
    
    ### 业务适应性挑战
    - **规则更新**：评分规则需要根据业务变化及时调整
    - **参数调优**：权重和阈值参数的最优化选择
    - **场景扩展**：从节日模式扩展到其他业务场景
    - **效果验证**：评分结果与实际业务效果的关联性验证
    
    ### 技术实现挑战
    - **单文件限制**：在有限的代码结构中实现复杂功能
    - **依赖控制**：仅使用pandas+numpy实现所有功能
    - **可维护性**：代码清晰度与功能复杂度的平衡
    - **错误处理**：各种异常情况的鲁棒性处理
  </challenge>
  
  <plan>
    ## 数据过滤系统实现计划
    
    ### Phase 1: 核心框架搭建
    1. **命令行参数解析** - argparse实现输入输出路径配置
    2. **文件读取模块** - 支持CSV/XLSX，自动编码检测
    3. **数据验证模块** - 字段完整性检查，数据类型验证
    4. **基础工具函数** - 标准化、归一化等通用函数
    
    ### Phase 2: 评分算法实现
    1. **长尾截断算法** - 99分位截断 + 对数标准化
    2. **Commission分段评分** - 四段式评分函数
    3. **余弦衰减算法** - 达人影响力评分
    4. **指数衰减算法** - 排名表现评分
    5. **增长潜力评分** - 销售1y×增长率计算
    6. **渠道分布评分** - live/card渠道得分
    7. **转化率过滤** - 阈值过滤+线性映射
    
    ### Phase 3: 节日模式系统
    1. **节日配置表** - 硬编码节日列表
    2. **日期计算函数** - 计算距离下一节日的天数
    3. **权重调整算法** - 动态权重重新分配
    4. **模式切换逻辑** - 自动检测并切换节日模式
    
    ### Phase 4: 输出与优化
    1. **总分计算** - 加权求和，排序筛选
    2. **去重处理** - 按product_url去重
    3. **结果输出** - 格式化CSV输出
    4. **性能优化** - 向量化计算，内存优化
    5. **错误处理** - 异常捕获，友好提示
    
    ### 质量保证计划
    - **单元测试**：每个评分函数独立测试
    - **集成测试**：完整流程端到端测试  
    - **性能测试**：大数据量处理性能验证
    - **边界测试**：异常数据和边界条件测试
  </plan>
</thought>
