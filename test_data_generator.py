#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨
ä¸ºæŠ–éŸ³æ•°æ®æ¸…æ´—å·¥å…·ç”Ÿæˆæµ‹è¯•ç”¨çš„Excelæ–‡ä»¶
"""

import pandas as pd
import numpy as np
from datetime import datetime
import os

def create_test_data():
    """åˆ›å»ºæµ‹è¯•ç”¨çš„æŠ–éŸ³ç”µå•†æ•°æ®"""
    
    # æ¨¡æ‹Ÿä¸åŒçš„å­—æ®µåç§°ï¼ˆç”¨æˆ·å®é™…é‡åˆ°çš„å„ç§åˆ«åï¼‰
    test_data_1 = {
        'å•†å“': ['iPhone 15 Pro Max', 'åä¸ºMate60', 'å°ç±³14 Ultra', 'ä¸‰æ˜ŸGalaxy S24', 'OPPO Find X7'],
        'å•†å“é“¾æ¥': [
            'https://douyin.com/product/123456',
            'https://douyin.com/product/123457', 
            'https://douyin.com/product/123458',
            'https://douyin.com/product/123459',
            'https://douyin.com/product/123460'
        ],
        'å•†å“åˆ†ç±»': ['æ‰‹æœºæ•°ç ', 'æ‰‹æœºæ•°ç ', 'æ‰‹æœºæ•°ç ', 'æ‰‹æœºæ•°ç ', 'æ‰‹æœºæ•°ç '],
        'ä½£é‡‘æ¯”ä¾‹': ['15%', '12%', '18%', '10%', '20%'],
        'è¿‘7å¤©é”€é‡': ['1.2w', '8500', '2.5w', '5600', '1.8w'],
        'è¿‘7å¤©é”€å”®é¢': ['2400w', '1700w', '5000w', '1120w', '3600w'],
        'è¿‘30å¤©é”€é‡': ['5.2w', '3.5w', '10.8w', '2.3w', '7.2w'],
        'è¿‘30å¤©é”€å”®é¢': ['1.04äº¿', '7000w', '2.16äº¿', '4600w', '1.44äº¿'],
        'æ’å': [1, 2, 3, 4, 5],
        'å…³è”è¾¾äºº': ['æä½³ç¦', 'è–‡å¨…', 'è¾›å·´', 'ç½—æ°¸æµ©', 'è‘£å®‡è¾‰']
    }
    
    # åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶
    df1 = pd.DataFrame(test_data_1)
    
    # æ¨¡æ‹Ÿå¦ä¸€ç§å­—æ®µå‘½åæ–¹å¼
    test_data_2 = {
        'äº§å“å': ['æˆ´æ£®å¹é£æœº', 'é›…è¯—å…°é»›é¢éœœ', 'å…°è”»ç²¾å', 'æµ·è“ä¹‹è°œé¢è†œ', 'SK-IIç¥ä»™æ°´'],
        'æŠ–éŸ³å•†å“é“¾æ¥': [
            'https://dy.com/item/234567',
            'https://dy.com/item/234568',
            'https://dy.com/item/234569', 
            'https://dy.com/item/234570',
            'https://dy.com/item/234571'
        ],
        'ä¸€çº§åˆ†ç±»': ['ç¾å¦†æŠ¤è‚¤', 'ç¾å¦†æŠ¤è‚¤', 'ç¾å¦†æŠ¤è‚¤', 'ç¾å¦†æŠ¤è‚¤', 'ç¾å¦†æŠ¤è‚¤'],
        'ä½£é‡‘': ['25%', '30%', '28%', '35%', '32%'],
        '7å¤©é”€é‡': ['3200', '2800', '4100', '1900', '3600'],
        '7å¤©GMV': ['960w', '840w', '1230w', '570w', '1080w'],
        '30å¤©é”€é‡': ['1.5w', '1.2w', '1.8w', '8500', '1.6w'],
        '30å¤©é”€å”®é¢': ['4500w', '3600w', '5400w', '2550w', '4800w'],
        'è½¬åŒ–ç‡': ['8.5%', '12.3%', '9.8%', '15.2%', '11.7%'],
        'åæ¬¡': [1, 2, 3, 4, 5],
        'å¸¦è´§è¾¾äºº': ['å¼ å¤§å¥•', 'é›ªæ¢¨', 'æ—çŠçŠ', 'é™ˆæ´kiki', 'å¼ æ²«å‡¡']
    }
    
    df2 = pd.DataFrame(test_data_2)
    
    # åˆ›å»ºè¾“å‡ºç›®å½•
    if not os.path.exists('test_data'):
        os.makedirs('test_data')
    
    # åˆ›å»ºç¬¬ä¸‰ä¸ªæµ‹è¯•æ•°æ®é›†ï¼ˆCSVæ ¼å¼ï¼‰
    test_data_3 = {
        'å•†å“åç§°': ['Nike Air Max', 'Adidas Ultra Boost', 'New Balance 990', 'Converse Chuck Taylor', 'Vans Old Skool'],
        'é“¾æ¥': [
            'https://douyin.com/shoes/345678',
            'https://douyin.com/shoes/345679',
            'https://douyin.com/shoes/345680',
            'https://douyin.com/shoes/345681',
            'https://douyin.com/shoes/345682'
        ],
        'ç±»ç›®': ['è¿åŠ¨é‹æœ', 'è¿åŠ¨é‹æœ', 'è¿åŠ¨é‹æœ', 'è¿åŠ¨é‹æœ', 'è¿åŠ¨é‹æœ'],
        'åˆ†æˆ': ['22%', '25%', '20%', '18%', '24%'],
        '7æ—¥é”€é‡': ['2.1w', '1.8w', '1.5w', '3.2w', '2.7w'],
        'å‘¨GMV': ['1260w', '1080w', '900w', '1920w', '1620w'],
        'æœˆé”€é‡': ['8.5w', '7.2w', '6.0w', '12.8w', '10.8w'],
        'æœˆGMV': ['5100w', '4320w', '3600w', '7680w', '6480w'],
        'è½¬æ¢ç‡': ['6.8%', '9.2%', '7.5%', '11.3%', '8.9%'],
        'æ’è¡Œ': [1, 2, 3, 4, 5],
        'è¾¾äºº': ['æ½®æµå°ç‹å­', 'è¿åŠ¨è¾¾äºº', 'è¡—å¤´é£å°š', 'çƒé‹æ”¶è—å®¶', 'æ—¶å°šåšä¸»']
    }

    df3 = pd.DataFrame(test_data_3)

    # ä¿å­˜æµ‹è¯•æ–‡ä»¶ - æµ‹è¯•ä¸åŒçš„æ—¶é—´æ ¼å¼
    timestamp = datetime.now().strftime("%Y%m%d")

    # æ–‡ä»¶ååŒ…å«ä¸åŒçš„æ—¶é—´æ ¼å¼ï¼Œç”¨äºæµ‹è¯•æ—¶é—´æå–åŠŸèƒ½
    filenames = [
        # æ—¥æœŸåŒºé—´æ ¼å¼
        f'test_data/é”€é‡æ¦œ-æ‰‹æœºæ•°ç -{timestamp}-20250630.xlsx',
        # ç›¸å¯¹æ—¶é—´æ ¼å¼
        f'test_data/çƒ­æ¨æ¦œ-ç¾å¦†æŠ¤è‚¤-30d.xlsx',
        # å•æ—¥æœŸæ ¼å¼ + CSV
        f'test_data/æ½œåŠ›æ¦œ-è¿åŠ¨é‹æœ-{timestamp}.csv',
        # æ··åˆæ ¼å¼
        f'test_data/æŒç»­å¥½è´§æ¦œ-æ•°ç é…ä»¶-7d-{timestamp}.xlsx',
        # å¹´åº¦æ ¼å¼
        f'test_data/åŒæœŸæ¦œ-å®¶å±…ç”¨å“-1y.csv'
    ]

    # ä¿å­˜ä¸åŒæ ¼å¼çš„æ–‡ä»¶
    df1.to_excel(filenames[0], index=False, engine='openpyxl')
    df2.to_excel(filenames[1], index=False, engine='openpyxl')
    df3.to_csv(filenames[2], index=False, encoding='utf-8')
    df1.to_excel(filenames[3], index=False, engine='openpyxl')
    df2.to_csv(filenames[4], index=False, encoding='utf-8')

    print(f"âœ… æµ‹è¯•æ•°æ®å·²ç”Ÿæˆ (åŒ…å«å¤šç§æ—¶é—´æ ¼å¼):")
    for i, filename in enumerate(filenames):
        print(f"   ğŸ“ {filename}")

    print(f"\nğŸ¯ æµ‹è¯•åŠŸèƒ½è¦†ç›–:")
    print(f"   âœ… ä¸åŒå­—æ®µå‘½åæ–¹å¼çš„æ™ºèƒ½æ˜ å°„")
    print(f"   âœ… Excel(.xlsx) å’Œ CSV(.csv) æ ¼å¼æ”¯æŒ")
    print(f"   âœ… å¤šç§æ—¶é—´æ ¼å¼æå–:")
    print(f"      â€¢ æ—¥æœŸåŒºé—´: YYYYMMDD-YYYYMMDD")
    print(f"      â€¢ ç›¸å¯¹æ—¶é—´: 30d, 7d, 1y")
    print(f"      â€¢ å•æ—¥æœŸ: YYYYMMDD")
    print(f"      â€¢ æ··åˆæ ¼å¼: 7d-YYYYMMDD")
    print(f"   âœ… æ¦œå•ç±»å‹å’Œæ•°æ®æ¥æºæå–")

if __name__ == "__main__":
    create_test_data()
